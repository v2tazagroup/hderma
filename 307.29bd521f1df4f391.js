"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[307],{1307:(xt,w,a)=>{a.r(w),a.d(w,{DonhangModule:()=>Tt});var D=a(4755),x=a(2480),b=a(3144),C=a(9401),R=a(2944),B=a(4800),A=a(3276),k=a(2611),d=a(3204),$=a(964),S=a(5258);const H=[{id:1,Tieude:"\u0110\u01a1n M\u1edbi"},{id:2,Tieude:"\u0110\xe3 G\u1eedi H\xe0ng"},{id:3,Tieude:"\u0110\xe3 Nh\u1eadn"},{id:4,Tieude:"H\u1ee7y \u0110\u01a1n"}];var t=a(2223),U=a(6729),m=a(1135),u=a(4004),f=a(5698),p=a(3900),O=a(2843),N=a(9646);let E=(()=>{class r{get donhang$(){return this._donhang.asObservable()}get donhang1$(){return this._donhang1.asObservable()}get donhangchitiet$(){return this._donhangchitiet.asObservable()}constructor(e){this.http=e,this.urlApi=U.N.APIURL,this._donhang=new m.X(null),this._donhang1=new m.X(null),this._donhangchitiet=new m.X(null)}createDiem(e){return this.http.post(this.urlApi+"/hderma-customer-diem",e).pipe((0,u.U)(i=>(console.log(i),i)))}postDonhang(e){return this.donhang$.pipe((0,f.q)(1),(0,p.w)(i=>this.http.post(this.urlApi,e).pipe((0,u.U)(n=>(this._donhang.next([n,...i]),n)))))}getDonhang(){return this.http.get(this.urlApi+"/hderma-donhang").pipe((0,u.U)(e=>(console.log(e),this._donhang.next(e),e)))}getDonhangbyMDH(e){return this.http.get(this.urlApi+`/hderma-donhang/madonhang/${e}`).pipe((0,u.U)(i=>i))}getOneDonhang(e){return this.http.get(this.urlApi+`/hderma-donhang/${e}`).pipe((0,u.U)(i=>(this._donhang1.next(i),i)))}getDonhangByidKH(e){return this.http.get(this.urlApi+`/hderma-donhang/user/${e}`).pipe((0,u.U)(i=>(console.log(i),this._donhang.next(i),i)))}getAllDonhangChitiet(e){return this.http.get(this.urlApi+"/hderma-donhangchitiet").pipe((0,u.U)(i=>(this._donhangchitiet.next(i),i)),(0,p.w)(i=>i?(0,N.of)(i):(0,O._)("Could not found course with id of "+e+"!")))}getDonhangchitiet(e){return this.http.get(this.urlApi+`/${e}`).pipe((0,u.U)(i=>(this._donhangchitiet.next(i),i)),(0,p.w)(i=>i?(0,N.of)(i):(0,O._)("Could not found course with id of "+e+"!")))}deleteDonhang(e){return this.donhang$.pipe((0,f.q)(1),(0,p.w)(i=>this.http.delete(this.urlApi+`/hderma-donhang/${e}`).pipe((0,u.U)(n=>{const o=i.filter(h=>h.id!=e);return this._donhang.next(o),n}))))}updateDonhang(e){return this.donhang$.pipe((0,f.q)(1),(0,p.w)(i=>this.http.patch(this.urlApi+`/hderma-donhang/${e.id}`,e).pipe((0,u.U)(n=>{console.log(n);const o=i.findIndex(h=>h.id===e.id);return i[o]=e,this._donhang.next(i),n}))))}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(b.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var L=a(4289);let Y=(()=>{class r{get links$(){return this._links.asObservable()}get link$(){return this._link.asObservable()}constructor(e){this.http=e,this.urlApi=U.N.APIURL,this._links=new m.X(null),this._link=new m.X(null)}postLink(e){return this.links$.pipe((0,f.q)(1),(0,p.w)(i=>this.http.post(this.urlApi+"/hderma-link",e).pipe((0,u.U)(n=>(this._links.next(i?.length>0?[n,...i]:[n]),n)))))}getLink(){return this.http.get(this.urlApi+"/hderma-link").pipe((0,u.U)(e=>(this._links.next(e),e)))}getLinkDetail(e){return this.http.get(this.urlApi+`/hderma-link/${e}`).pipe((0,u.U)(i=>(this._link.next(i),i)))}updateLink(e){return this.links$.pipe((0,f.q)(1),(0,p.w)(i=>this.http.patch(this.urlApi+`/hderma-link/${e.id}`,e).pipe((0,u.U)(n=>{if(i?.length>0){let o=i.findIndex(h=>h.id==e.id);i[o]=e,this._links.next(i)}else this._links.next([n]);return n}))))}deleteLink(e){return this.links$.pipe((0,f.q)(1),(0,p.w)(i=>this.http.delete(this.urlApi+`/hderma-link/${e}`).pipe((0,u.U)(n=>{const o=i.filter(h=>h.id!=e);return this._links.next(o),n}))))}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(b.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var F=a(9016),_=a(8505);let G=(()=>{class r{constructor(e){this._httpClient=e,this.APIURL=U.N.APIURL,this._tichdiem=new m.X(null),this._tichdiems=new m.X(null),this._customer=new m.X(null),this._customers=new m.X(null)}get tichdiems$(){return this._tichdiems.asObservable()}get tichdiem$(){return this._tichdiem.asObservable()}getTichdiem(e){return this._httpClient.get(`${this.APIURL}/hderma-customer/diem/${e}`).pipe((0,_.b)(i=>i))}getByid(e){return this._httpClient.get(`${this.APIURL}/hderma-customer-diem/${e}`).pipe((0,_.b)(i=>{this._tichdiem.next(i)}))}getAll(){return this._httpClient.get(`${this.APIURL}/hderma-customer-diem`).pipe((0,_.b)(e=>{this._tichdiems.next(e)}))}createTichdiem(e){return this._httpClient.post(`${this.APIURL}/hderma-customer-diem`,e).pipe((0,u.U)(i=>i))}updateTichdiem(e){return this.tichdiems$.pipe((0,f.q)(1),(0,p.w)(i=>this._httpClient.patch(`${this.APIURL}/hderma-customer-diem/${e.id}`,e).pipe((0,u.U)(n=>{const o=i.findIndex(h=>h.id===n.id);return i[o]=n,this._tichdiems.next(i),n}))))}deleteTichdiem(e){return this.tichdiems$.pipe((0,f.q)(1),(0,p.w)(i=>this._httpClient.delete(`${this.APIURL}/hderma-customer-diem/${e.id}`).pipe((0,u.U)(n=>{const o=i.filter(h=>h.id!=e.id);return this._tichdiems.next(o),n}))))}get customers$(){return this._customers.asObservable()}get customer$(){return this._customer.asObservable()}getCustomerByid(e){return this._httpClient.get(`${this.APIURL}/hderma-customer/${e}`).pipe((0,_.b)(i=>{this._customer.next(i)}))}getCustomerByidUser(e){return this._httpClient.get(`${this.APIURL}/hderma-customer/idUser/${e}`).pipe((0,_.b)(i=>i))}getAllCustomer(){return this._httpClient.get(`${this.APIURL}/hderma-customer`).pipe((0,_.b)(e=>{this._customers.next(e)}))}createCustomer(e){return this._httpClient.post(`${this.APIURL}/hderma-customer`,e).pipe((0,u.U)(i=>i))}updateCustomer(e){return this._httpClient.patch(`${this.APIURL}/hderma-customer/${e.id}`,e).pipe((0,u.U)(i=>i))}deleteCustomer(e){return this.customers$.pipe((0,f.q)(1),(0,p.w)(i=>this._httpClient.delete(`${this.APIURL}/hderma-customer/${e.id}`).pipe((0,u.U)(n=>{const o=i.filter(h=>h.id!=e.id);return this._customers.next(o),n}))))}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(b.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var M=a(6286),J=a(1728),Q=a(8097),P=a(9114),q=a(2214),j=a(3649),I=a(5441);function z(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"M\xe3 \u0110H"),t.qZA())}function K(r,s){1&r&&(t.TgZ(0,"span",36),t._uU(1,"visibility"),t.qZA())}const X=function(r){return[r]};function V(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"td",33),t.NdJ("click",function(){const o=t.CHM(e).$implicit,h=t.oxw();return t.MAs(2).open(),t.KtG(h.Daxem(o,"Status",1))}),t.TgZ(1,"div",34)(2,"span"),t._uU(3),t.qZA(),t.YNc(4,K,2,0,"span",35),t.qZA()()}if(2&r){const e=s.$implicit;t.Q6J("routerLink",t.VKq(3,X,e.id)),t.xp6(3),t.Oqu(e.MaDonHang),t.xp6(1),t.Q6J("ngIf",1==e.Status)}}function W(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"H\u1ecd T\xean"),t.qZA())}function tt(r,s){if(1&r&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&r){const e=s.$implicit;t.xp6(1),t.hij(" ",e.Hoten," ")}}function et(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"S\u1ed1 \u0110i\u1ec7n Tho\u1ea1i"),t.qZA())}function it(r,s){if(1&r&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&r){const e=s.$implicit;t.xp6(1),t.hij(" ",e.SDT," ")}}function nt(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"\u0110\u1ecba Ch\u1ec9"),t.qZA())}function rt(r,s){if(1&r&&(t.TgZ(0,"td",37),t._uU(1),t.qZA()),2&r){const e=s.$implicit;t.xp6(1),t.HOy(" ",e.Diachi.Diachi+","||0," ",e.Diachi.Phuong+","||0," ",e.Diachi.Quan+","||0," ",e.Diachi.Tinh||""," ")}}function ot(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"Ghi Ch\xfa"),t.qZA())}function st(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"td",37)(1,"div",38)(2,"mat-form-field",39)(3,"mat-label"),t._uU(4,"Ghi Ch\xfa"),t.qZA(),t.TgZ(5,"textarea",40),t.NdJ("ngModelChange",function(n){const h=t.CHM(e).$implicit;return t.KtG(h.Ghichu=n)}),t.qZA()(),t.TgZ(6,"button",41),t.NdJ("click",function(){const o=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.UpdateStatus(o,"Ghichu",o.Ghichu))}),t.TgZ(7,"span",42),t._uU(8,"done"),t.qZA()()()()}if(2&r){const e=s.$implicit;t.xp6(5),t.Q6J("value",e.Ghichu)("ngModel",e.Ghichu)}}function ht(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"Ng\xe0y T\u1ea1o"),t.qZA())}function at(r,s){if(1&r&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"date"),t.qZA()),2&r){const e=s.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.Ngaytao,"hh:mm:ss dd/MM/yy")," ")}}function ct(r,s){1&r&&(t.TgZ(0,"th",32),t._uU(1,"Tr\u1ea1ng th\xe1i"),t.qZA())}function ut(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"td",37)(1,"span",43,44),t.NdJ("click",function(){const o=t.CHM(e).$implicit,h=t.MAs(2),g=t.oxw();return t.KtG(g.toggle(h,o))}),t._uU(3),t.qZA()()}if(2&r){const e=s.$implicit,i=t.oxw();t.xp6(1),t.Gre("cursor-pointer p-2 rounded text-white ",1==e.Trangthai?"bg-blue-500":2==e.Trangthai?"bg-yellow-500":3==e.Trangthai?"bg-green-500":4==e.Trangthai?"bg-red-500":"",""),t.xp6(2),t.hij(" ",i.Findbyid(e.Trangthai,i.TTDonhang)," ")}}function lt(r,s){1&r&&t._UZ(0,"tr",45)}function dt(r,s){1&r&&t._UZ(0,"tr",46)}function pt(r,s){1&r&&(t.TgZ(0,"tr",47)(1,"td",48),t._uU(2,"Kh\xf4ng T\xecm Th\u1ea5y"),t.qZA()())}function gt(r,s){if(1&r){const e=t.EpF();t.TgZ(0,"div",51),t.NdJ("click",function(){const o=t.CHM(e).$implicit,h=t.oxw(2);return h.selectTrangthai(h.selectRow,o.id),t.KtG(h.isOpen=!h.isOpen)}),t.TgZ(1,"div",52),t._uU(2),t.qZA()()}if(2&r){const e=s.$implicit;t.Gre("hover:text-white px-3 py-1 cursor-pointer  ",1==e.id?"hover:bg-blue-500":2==e.id?"hover:bg-yellow-500":3==e.id?"hover:bg-green-500":4==e.id?"hover:bg-red-500":"",""),t.xp6(2),t.hij(" ",e.Tieude," ")}}function mt(r,s){if(1&r&&(t.TgZ(0,"div",49),t.YNc(1,gt,3,4,"div",50),t.qZA()),2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.TTDonhang)}}const ft=function(){return[5,10,25,100]};let vt=(()=>{class r{constructor(e,i,n,o,h,g,Z){this.fb=e,this.donhangService=i,this._sanphamService=n,this._linkService=o,this._notifierService=h,this._tichdiemService=g,this.dialog=Z,this.displayedColumns1=["TenSP","Soluong","Dongia","Khuyenmai","Ghichu","Trangthai","Gioithieu"],this.dataSource1=new d.by,this.displayedColumns=["MaDonHang","Hoten","SDT","Diachi","Ghichu","Ngaytao","Trangthai"],this.TTDonhang=H,this.isOpen=!1,this.DonHangs=[],this.users={},this.arr=[],this.customer={},this.customer_diem={},this.selectRow={},this._transformer=(l,c)=>({expandable:!!l.children&&l.children.length>0,level:c,...l}),this.treeControl=new $.C2(l=>l.level,l=>l.expandable),this.treeFlattener=new S.JZ(this._transformer,l=>l.level,l=>l.expandable,l=>l.children),this.hasChild=(l,c)=>c.expandable,this.hasNoContent=(l,c)=>""===c.name,this.dataSourceTree=new S.kc(this.treeControl,this.treeFlattener),this.nest=(l,c="",v="pid")=>l?.filter(T=>T[v]==c).map(T=>({...T,children:this.nest(l,T.id)}))}ngOnInit(){this._sanphamService.getProduct().subscribe(),this._sanphamService.products$.subscribe(e=>this.products=e),this.donhangService.getDonhang().subscribe(),this.donhangService.donhang$.subscribe(e=>{e&&(this.DonHangs=e,console.log(e),this.dataSource=new d.by(this.DonHangs),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)}),this._linkService.getLink().subscribe()}Findbyid(e,i){const n=i.find(o=>o.id==e);return n?n.Tieude:""}Daxem(e,i,n){delete e.Donhangchitiets,e[i]=n,this.donhangService.updateDonhang(e).subscribe()}UpdateStatus(e,i,n){delete e.Donhangchitiets,e[i]=n,this.donhangService.updateDonhang(e).subscribe(o=>{this._notifierService.notify("success","C\u1eadp Nh\u1eadt Th\xe0nh C\xf4ng")})}selectTrangthai(e,i){3==i&&(this.customer_diem.idUser=e.idKH,this.customer_diem.idDonHang=e.id,this.customer_diem.Diemcap=this.customer_diem.Diemqua=e.Donhangchitiets.reduce((n,o)=>n+o.Dongia,0)/1e4,this._tichdiemService.createTichdiem(this.customer_diem).subscribe(n=>{this._tichdiemService.getCustomerByidUser(n.idUser).subscribe(o=>{o?(this.customer=o,this.customer.TongDiemcap+=n.Diemcap,this.customer.TongDiemqua+=n.Diemqua,this._tichdiemService.updateCustomer(this.customer).subscribe(h=>{this.customer={}}),this.ngOnInit()):(this.customer.idUser=n.idUser,this.customer.TongDiemcap=n.Diemcap,this.customer.TongDiemqua=n.Diemqua,this._tichdiemService.createCustomer(this.customer).subscribe(h=>{this.customer={}}),this.ngOnInit())})})),delete e.Donhangchitiets,e.Trangthai=i,this.donhangService.updateDonhang(e).subscribe(),this._notifierService.notify("success","C\u1eadp Nh\u1eadt \u0110\u01a1n H\xe0ng Th\xe0nh C\xf4ng")}getParent(e,i){let n=e.find(o=>o.pid==i);return n&&(this.arr.push(n),this.getParent(e,n.id)),n}openDialog(e,i){this.dataSourceTree.data=[],this.arr=[],this.dialog.open(i),this._linkService.getLinkDetail(e.idGioithieu).subscribe(n=>{n&&this._linkService.links$.subscribe(o=>{if(o){if(""!=n.pid){let h=o.find(g=>g.id==n.pid);this.arr.push(h)}this.arr.push(n),n.isCheck=!0,this.getParent(o,n.id),this.dataSourceTree.data=this.nest(this.arr)}})})}SelectDonhang(e){this.dataSource1=new d.by(e.Donhangchitiets)}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}toggle(e,i){this.selectRow=i,this.triggerOrigin=e,this.isOpen=!this.isOpen}filterDonhang(e){this.dataSource=new d.by(this.DonHangs.filter(i=>i.Hoten.toLowerCase().includes(e))),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(C.qu),t.Y36(E),t.Y36(L.M),t.Y36(Y),t.Y36(F.lG),t.Y36(G),t.Y36(M.uw))},r.\u0275cmp=t.Xpm({type:r,selectors:[["tazagroup-donhang"]],viewQuery:function(e,i){if(1&e&&(t.Gf(A.NW,5),t.Gf(k.YE,5)),2&e){let n;t.iGM(n=t.CRH())&&(i.paginator=n.first),t.iGM(n=t.CRH())&&(i.sort=n.first)}},decls:48,vars:8,consts:[["autosize","",1,"flex","flex-col","flex-auto","w-full","min-h-[80vh]"],["mode","over","position","end",1,"example-sidenav","lg:w-2/3","w-full"],["drawer",""],[1,"absolute","z-10"],[1,"material-icons","p-3","hover:bg-gray-200","rounded-full",3,"click"],[1,"flex","flex-col","w-full"],[1,"flex","flex-row"],[1,"px-3"],[1,"flex","flex-row","space-x-3","py-3","items-center","min-h-[50px]","justify-between"],[1,"flex","rounded-md","border-2","border-slate-100","w-full"],["id","user","type","text","placeholder","T\xecm Ki\u1ebfm",1,"block","w-full","py-4","px-2","first-letter:w-full","bg-transparent","rounded-lg","appearance-none","focus:outline-none","focus:ring-0","focus:border-blue-600","peer"],[1,"inline-flex","items-center","px-3"],[1,"material-icons"],["matTooltip","T\xf9y Ch\u1ec9nh",1,"material-icons","p-2","hover:bg-slate-200","rounded-lg"],["matTooltip","Upload File",1,"material-icons","p-2","hover:bg-slate-200","rounded-lg"],[1,"w-full","overflow-auto"],["mat-table","",1,"mat-elevation-z8","w-full",3,"dataSource"],["matColumnDef","MaDonHang"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"routerLink","click",4,"matCellDef"],["matColumnDef","Hoten"],["mat-cell","",4,"matCellDef"],["matColumnDef","SDT"],["matColumnDef","Diachi"],["matColumnDef","Ghichu"],["matColumnDef","Ngaytao"],["matColumnDef","Trangthai"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["pageSize","10",3,"pageSizeOptions"],["cdkConnectedOverlay","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayHasBackdrop","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","backdropClick"],["mat-header-cell",""],["mat-cell","",3,"routerLink","click"],[1,"flex","items-center","space-x-2","justify-left"],["class","material-icons text-sm text-blue-500","matTooltip","\u0110\xe3 Xem",4,"ngIf"],["matTooltip","\u0110\xe3 Xem",1,"material-icons","text-sm","text-blue-500"],["mat-cell",""],[1,"flex","flex-row","w-full","px-4","items-center"],["appearance","outline",1,"w-full"],["matInput","","rows","1",3,"value","ngModel","ngModelChange"],["mat-icon-button","",1,"hover:bg-blue-200",3,"click"],[1,"material-icons","text-sm"],["cdkOverlayOrigin","",3,"click"],["triggerTaotailieu","cdkOverlayOrigin"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"],[1,"max-h-64","py-2","bg-white","shadow","space-y-2","overflow-y-auto","rounded-md"],[3,"class","click",4,"ngFor","ngForOf"],[3,"click"],[1,"text-sm"]],template:function(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"mat-drawer-container",0)(1,"mat-drawer",1,2)(3,"div",3)(4,"span",4),t.NdJ("click",function(){t.CHM(n);const h=t.MAs(2);return t.KtG(h.close())}),t._uU(5," arrow_forward "),t.qZA()(),t._UZ(6,"router-outlet"),t.qZA(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9),t._UZ(12,"input",10),t.TgZ(13,"div",11)(14,"span",12),t._uU(15,"search"),t.qZA()()(),t.TgZ(16,"span",13),t._uU(17," tune "),t.qZA(),t.TgZ(18,"span",14),t._uU(19," file_upload "),t.qZA()()()(),t.TgZ(20,"div",15)(21,"table",16),t.ynx(22,17),t.YNc(23,z,2,0,"th",18),t.YNc(24,V,5,5,"td",19),t.BQk(),t.ynx(25,20),t.YNc(26,W,2,0,"th",18),t.YNc(27,tt,2,1,"td",21),t.BQk(),t.ynx(28,22),t.YNc(29,et,2,0,"th",18),t.YNc(30,it,2,1,"td",21),t.BQk(),t.ynx(31,23),t.YNc(32,nt,2,0,"th",18),t.YNc(33,rt,2,4,"td",21),t.BQk(),t.ynx(34,24),t.YNc(35,ot,2,0,"th",18),t.YNc(36,st,9,2,"td",21),t.BQk(),t.ynx(37,25),t.YNc(38,ht,2,0,"th",18),t.YNc(39,at,3,4,"td",21),t.BQk(),t.ynx(40,26),t.YNc(41,ct,2,0,"th",18),t.YNc(42,ut,4,4,"td",21),t.BQk(),t.YNc(43,lt,1,0,"tr",27),t.YNc(44,dt,1,0,"tr",28),t.YNc(45,pt,3,0,"tr",29),t.qZA(),t._UZ(46,"mat-paginator",30),t.qZA()()(),t.YNc(47,mt,2,1,"ng-template",31),t.NdJ("backdropClick",function(){return i.isOpen=!i.isOpen})}2&e&&(t.xp6(21),t.Q6J("dataSource",i.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(7,ft)),t.xp6(1),t.Q6J("cdkConnectedOverlayHasBackdrop",!0)("cdkConnectedOverlayOrigin",i.triggerOrigin)("cdkConnectedOverlayOpen",i.isOpen))},dependencies:[D.sg,D.O5,C.Fj,C.JJ,C.On,J.RK,Q.Nt,P.KE,P.hX,A.NW,q.jA,q.kh,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,d.Ee,j.gM,I.pI,I.xu,x.lC,x.rH,D.uU]}),r})();var Ct=a(3630);function Dt(r,s){if(1&r&&(t.TgZ(0,"div",9)(1,"div"),t._uU(2),t.qZA(),t.TgZ(3,"div",10)(4,"div",11),t._uU(5),t.ALo(6,"number"),t.qZA(),t.TgZ(7,"div",6),t._uU(8),t.ALo(9,"number"),t.qZA()()()),2&r){const e=s.$implicit,i=s.index;t.xp6(2),t.AsE("",i+1," ",e.Product.Tieude,""),t.xp6(3),t.AsE("",e.Soluong,"x",t.xi3(6,5,e.Dongia,"1.0-2"),""),t.xp6(3),t.hij("",t.xi3(9,8,e.Soluong*e.Dongia,"1.0-2")," \u0111")}}let _t=(()=>{class r{constructor(e,i,n,o,h,g,Z,l){this.fb=e,this.donhangService=i,this._sanphamService=n,this._linkService=o,this._notifierService=h,this._tichdiemService=g,this.dialog=Z,this.route=l,this.displayedColumns1=["TenSP","Soluong","Dongia","Ghichu","Trangthai"],this.dataSource1=new d.by,this.displayedColumns=["Hoten","SDT","Diachi","Ngaytao","Trangthai","action"],this.TTDonhang=H,this.isOpen=!1,this.DonHangs=[],this.users={},this.arr=[],this.customer={},this.customer_diem={},this.selectRow={},this.DHChitiet={},this._transformer=(c,v)=>({expandable:!!c.children&&c.children.length>0,level:v,...c}),this.treeControl=new $.C2(c=>c.level,c=>c.expandable),this.treeFlattener=new S.JZ(this._transformer,c=>c.level,c=>c.expandable,c=>c.children),this.hasChild=(c,v)=>v.expandable,this.hasNoContent=(c,v)=>""===v.name,this.dataSourceTree=new S.kc(this.treeControl,this.treeFlattener),this.nest=(c,v="",T="pid")=>c?.filter(y=>y[T]==v).map(y=>({...y,children:this.nest(c,y.id)}))}ngOnInit(){this._sanphamService.getProduct().subscribe(),this._sanphamService.products$.subscribe(e=>this.products=e),this.route.params.subscribe(e=>{this.donhangService.getOneDonhang(e.id).subscribe(),this.donhangService.donhang1$.subscribe(i=>{i&&(this.DHChitiet=i,console.log(i.Donhangchitiets),this.dataSource=new d.by(i.Donhangchitiets),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)})}),this._linkService.getLink().subscribe()}Total(e){return e.reduce((i,n)=>i+n.Soluong*n.Dongia,0)}Findbyid(e,i){const n=i.find(o=>o.id==e);return n?n.Tieude:""}selectTrangthai(e,i){3==i&&(this.customer_diem.idUser=e.idKH,this.customer_diem.idDonHang=e.id,this.customer_diem.Diemcap=this.customer_diem.Diemqua=e.Donhangchitiets.reduce((n,o)=>n+o.Dongia,0)/1e4,this._tichdiemService.createTichdiem(this.customer_diem).subscribe(n=>{this._tichdiemService.getCustomerByidUser(n.idUser).subscribe(o=>{o?(this.customer=o,this.customer.TongDiemcap+=n.Diemcap,this.customer.TongDiemqua+=n.Diemqua,this._tichdiemService.updateCustomer(this.customer).subscribe(h=>{this.customer={}}),this.ngOnInit()):(this.customer.idUser=n.idUser,this.customer.TongDiemcap=n.Diemcap,this.customer.TongDiemqua=n.Diemqua,this._tichdiemService.createCustomer(this.customer).subscribe(h=>{this.customer={}}),this.ngOnInit())})})),delete e.Donhangchitiets,e.Trangthai=i,this.donhangService.updateDonhang(e).subscribe(),this._notifierService.notify("success","C\u1eadp Nh\u1eadt \u0110\u01a1n H\xe0ng Th\xe0nh C\xf4ng")}getParent(e,i){let n=e.find(o=>o.pid==i);return n&&(this.arr.push(n),this.getParent(e,n.id)),n}openDialog(e,i){this.dataSourceTree.data=[],this.arr=[],this.dialog.open(i),this._linkService.getLinkDetail(e.idGioithieu).subscribe(n=>{n&&this._linkService.links$.subscribe(o=>{if(o){if(""!=n.pid){let h=o.find(g=>g.id==n.pid);this.arr.push(h)}this.arr.push(n),n.isCheck=!0,this.getParent(o,n.id),this.dataSourceTree.data=this.nest(this.arr)}})})}SelectDonhang(e){this.dataSource1=new d.by(e.Donhangchitiets)}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}toggle(e,i){this.selectRow=i,this.triggerOrigin=e,this.isOpen=!this.isOpen}filterDonhang(e){this.dataSource=new d.by(this.DonHangs.filter(i=>i.Hoten.toLowerCase().includes(e))),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(C.qu),t.Y36(E),t.Y36(L.M),t.Y36(Y),t.Y36(F.lG),t.Y36(G),t.Y36(M.uw),t.Y36(x.gz))},r.\u0275cmp=t.Xpm({type:r,selectors:[["tazagroup-chitiet"]],viewQuery:function(e,i){if(1&e&&(t.Gf(A.NW,5),t.Gf(k.YE,5)),2&e){let n;t.iGM(n=t.CRH())&&(i.paginator=n.first),t.iGM(n=t.CRH())&&(i.sort=n.first)}},decls:24,vars:12,consts:[[1,"flex","flex-col","w-full","p-4"],[1,"text-xl","text-center","py-4","font-bold"],[1,"flex","flex-row","space-x-2"],[1,"flex","flex-col","space-y-2","bg-white","p-6","rounded-md","shadow"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"flex","flex-row","justify-between","font-bold"],[1,"text-blue-500"],[1,"flex","flex-col","space-y-3","bg-white","p-6","rounded-md","shadow","w-2/5"],[1,"flex","flex-row"],[1,"flex","flex-col"],[1,"flex","flex-row","justify-between"],[1,"italic"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2,"\u0110\u01a1n h\xe0ng chi ti\u1ebft"),t.qZA(),t.TgZ(3,"div",2)(4,"div",3),t.YNc(5,Dt,10,11,"div",4),t._UZ(6,"mat-divider"),t.TgZ(7,"div",5)(8,"div"),t._uU(9,"T\u1ed5ng C\u1ed9ng"),t.qZA(),t.TgZ(10,"div",6),t._uU(11),t.ALo(12,"number"),t.qZA()()(),t.TgZ(13,"div",7)(14,"div"),t._uU(15,"Kh\xe1ch h\xe0ng"),t.qZA(),t.TgZ(16,"div",8),t._uU(17),t.qZA(),t.TgZ(18,"div",8),t._uU(19),t.qZA(),t.TgZ(20,"div",8),t._uU(21),t.qZA(),t.TgZ(22,"div",8),t._uU(23),t.qZA()()()()),2&e&&(t.xp6(5),t.Q6J("ngForOf",i.DHChitiet.Donhangchitiets),t.xp6(6),t.hij("",t.xi3(12,9,i.Total(i.DHChitiet.Donhangchitiets),"1.0-2"),"\u0111 \u0111"),t.xp6(6),t.hij(" M\xe3 \u0110\u01a1n : ",i.DHChitiet.MaDonHang," "),t.xp6(2),t.hij("H\u1ecd T\xean : ",i.DHChitiet.Hoten,""),t.xp6(2),t.hij("S\u1ed1 \u0110i\u1ec7n Tho\u1ea1i : ",i.DHChitiet.SDT,""),t.xp6(2),t.HOy("\u0110\u1ecba Ch\u1ec9 : ",i.DHChitiet.Diachi.Diachi+","||0," ",i.DHChitiet.Diachi.Phuong+","||0," ",i.DHChitiet.Diachi.Quan+","||0," ",i.DHChitiet.Diachi.Tinh||""," "))},dependencies:[D.sg,Ct.d,D.JJ]}),r})(),Tt=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[D.ez,C.u5,b.JF,R.q,C.UX,B.Z_,x.Bz.forChild([{path:"",component:vt,children:[{path:":id",component:_t}]}]),x.Bz]}),r})()}}]);